# GroupTopk
## 参数说明
- **OpName**：GroupTopkOperation
- **PARAM**
**Param Type**：OpParam::GroupTopk
 
| 名称      | 类型       | 描述                     |
| -------- | ----------|------------------------|
| groupNum | int32_t   | 第二维d_1的分组数量           |
| k        | int32_t   | 在第二维d_1每一个行的全部分组中，保留前k个得分最大的组 |
| kInner   | int32_t   | 计算每组得分时取最大值的数量 |

- **In/Out Tensor**
 
| 名称        | 类型       | dims  | dtype        |format| 描述               |
|-----------|----------| ------- |--------------|------- |------------------|
| inTensor0 | In & Out | [$d_0$, $d_1$]| float16、bfloat16 |ND| 二维Tensor，对第二维$d_1$进行分组，选择前k个得分最大的组|
| inTensor1 | In       | [$1024$]| int32        |ND| 辅助序列，固定为[0, 1, ..., 1023] |

## 功能描述
- 算子功能：
对第一维$d_0$的每一个行，都进行以下四个步骤：
    - 将inTensor0的第二维$d_1$均匀划分为groupNum个组。
    - 计算每组中前kInner个最大值之和作为每组得分。
    - 根据每组得分的大小，选择前k个得分最大的组进行保留。
    - 将未被保留的组中的所有元素原地置为0。

## 示例
```
输入：
    inTensor0 = [[0.1, 0.2, 0.3, 0.4],
                [0.5, 0.6, 0.7, 0.8]]
    inTensor1 = [0, 1, ... ,1023] # 固定为0到1023的数组
    groupNum = 2
    k = 1
    kInner = 2

输出：
    inTensor0 = [[0.0, 0.0, 0.3, 0.4],
                [0.0, 0.0, 0.7, 0.8]] 
```
 
## 支持芯片型号
 
|芯片名称| 约束                                                                     | 
| ------------ |------------------------------------------------------------------------| 
|  ascend910b| $1 \leq d_1 \leq 1024$, $1 \leq k \leq groupNum \leq d_1$, $d_1$能被$groupNum$整除, $1 \leq kInner \leq \frac{d_1}{groupNum}$ |